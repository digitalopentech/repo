@startuml
actor DedeUI
participant "Kafka: request_topic" as KafkaRequest
participant "Kafka: response_topic" as KafkaResponse
participant "Kafka: error_topic" as KafkaError
participant Microservice

DedeUI -> KafkaRequest: Post request
KafkaRequest -> Microservice: Consume request
Microservice -> Microservice: Process with pinot-utils

alt Success
    Microservice -> KafkaResponse: Post success
    KafkaResponse -> DedeUI: Consume response
else Failure after retries
    Microservice -> KafkaError: Post error
    KafkaError -> DedeUI: Notify error
end

@enduml
